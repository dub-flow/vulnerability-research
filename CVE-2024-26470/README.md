# CVE-2024-26470: Host Header Injection in Forgot Password of FullStackHero's WebAPI Boilerplate versions 1.0.0 and 1.0.1

A host header injection vulnerability exists in the forgot password functionality of FullStackHero's WebAPI Boilerplate versions 1.0.0 and 1.0.1. By sending a specially crafted host header in the forgot password request, it is possible to send password reset links to users which, once clicked, lead to an attacker-controlled server and thus leak the password reset token. This may allow an attacker to reset other users' passwords.

PoC: 

- We trigger the forgot password functionality for an existing user, such as `bob@email.com`, and provide a malicious host header: `Host: attacker-controlled.com`
- This sends a password reset email to `bob@email.com` that contains the following:
```
Your Password Reset Token is '<token>'.
You can reset your password using the http://attacker-controlled.com/account/reset-password Endpoint.
```
- Note the host being `attacker-controlled.com`
- When `bob` clicks the link and attempts to use the password reset token, the token is leaked to the attacker which would allow resetting `bob's` password and taking over his account

Discovered by Florian Walter, August 2023.

References:

- https://nvd.nist.gov/vuln/detail/CVE-2024-26470
- https://www.cve.org/CVERecord?id=CVE-2024-26470
