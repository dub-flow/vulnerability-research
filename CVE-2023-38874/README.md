# CVE-2023-38874: RCE in gugaan's Economizzer 

A remote code execution (RCE) vulnerability via an insecure file upload exists in the commit 3730880 (April 2023) of gugoan's Economizzer. A malicious attacker can upload a PHP web shell as an attachment when adding a new cash book entry. Afterwards, the attacker may visit the web shell and execute arbitrary commands.

PoC:

- We login and create a new cash book entry that contains a PHP web shell as an attachment (e.g. `<?php echo system($_REQUEST['cmd']); ?>`), via the `Cashbook[file]` parameter of `POST /cashbook/create`.
- Note that the app has frontend validation that checks for an image file extension. However, this can be bypassed by talking directly to the backend
- Now, we browse to the URL of our web shell and can use it to execute arbitrary commands

Discovered by Florian Walter, July 2023.

References:

- <tbd>
